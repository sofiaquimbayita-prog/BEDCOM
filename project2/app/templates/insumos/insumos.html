{% extends "includes/base.html" %}
{% load static %}
{% block content %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Bedcom - Gesti√≥n de Insumos</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- ICONOS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- DATATABLES -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.8/css/jquery.dataTables.min.css">

    <!-- CSS -->
    <link rel="stylesheet" href="{% static 'ap1/css/insumos.css' %}" />


    <!-- JQUERY -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

<!-- DATATABLES JS -->
    <script src="https://cdn.datatables.net/1.13.8/js/jquery.dataTables.min.js"></script>

</head>

<body>



<main class="main-container">

    <div class="btn-agregar-container">
        <button class="btn-agregar" id="btn-agregar-insumo">
            <i class="fas fa-plus"></i>
            Agregar Insumo
        </button>
    </div>

    <!-- TABLA -->
    <table id="tablaInsumos" class="display">
        <thead>
            <tr>
                <th>Nombre</th>
                <th>Categor√≠a</th>
                <th>Cantidad</th>
                <th>Unidad</th>
                <th>Estado</th>
                <th>Acciones</th>
            </tr>
        </thead>
    </table>

</main>

<!-- MODAL CREAR -->
<div class="modal" id="modal-insumo">
    <div class="modal-contenido">
        <div class="modal-header">
            <h3 class="modal-titulo">Agregar Insumo</h3>
            <button class="btn-cerrar" id="btn-cerrar-modal">&times;</button>
        </div>

        <form method="post" action="{% url 'crear_insumo' %}">
            {% csrf_token %}

            <div class="form-grupo">
                <label>Nombre</label>
                <input type="text" name="nombre" class="form-input" required>
            </div>

            <div class="form-grupo">
                <label>Cantidad</label>
                <input type="number" name="cantidad" class="form-input" required>
            </div>

            <div class="form-grupo">
                <label>Unidad de Medida</label>
                <input type="text" name="unidad_medida" class="form-input" required>
            </div>

            <div class="form-grupo">
                <label>Categor√≠a</label>
                <select name="id_categoria" class="form-select" required>
                    <option value="">Seleccione</option>
                    {% for c in categorias %}
                        <option value="{{ c.id }}">{{ c.nombre }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="form-grupo">
                <label>Estado</label>
                <select name="estado" class="form-select">
                    <option value="Activo">Activo</option>
                    <option value="Inactivo">Inactivo</option>
                </select>
            </div>

            <div class="form-botones">
                <button type="button" class="btn-cancelar" id="btn-cancelar">Cancelar</button>
                <button type="submit" class="btn-guardar">Guardar</button>
            </div>
        </form>
    </div>
</div>

<!-- JS -->
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdn.datatables.net/1.13.8/js/jquery.dataTables.min.js"></script>

<script>
$(document).ready(function () {
    $('#tablaInsumos').DataTable({
        ajax: "{% url 'insumos_data' %}",
        columns: [
            { data: "nombre" },
            { data: "categoria" },
            { data: "cantidad" },
            { data: "unidad" },
            { data: "estado" },
            {
                data: "id",
                render: function (data) {
                    return `
                        <a href="/vistas/insumos/eliminar/${data}/" 
                           onclick="return confirm('¬øEliminar insumo?')">
                           üóëÔ∏è
                        </a>
                    `;
                }
            }
        ],
        language: {
            url: "//cdn.datatables.net/plug-ins/1.13.8/i18n/es-ES.json"
        }
    });
});
</script>

</body>
</html>
{% endblock %}