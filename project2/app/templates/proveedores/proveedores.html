{% extends "includes/base.html" %}
{% load static %}

{% block content %}

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<link rel="stylesheet" href="{% static 'ap1/css/proveedores.css' %}">

{% if messages %}
<div class="messages">
  {% for message in messages %}
    <div class="message {{ message.tags }}">{{ message }}</div>
  {% endfor %}
</div>
{% endif %}

<main class="content">
  <section class="providers-grid">

    <div class="card add-card" onclick="abrirModal('modalAdd')">
      <i class="fa-solid fa-user-plus"></i>
      <p>Agregar proveedor</p>
    </div>

    {% for prov in proveedores %}
    <div class="card provider {% if not prov.estado %}inactive-card{% endif %}" data-id="{{ prov.id }}">

      <div class="logo">
        <img 
          src="https://via.placeholder.com/300x200?text=Proveedor" 
          alt="Proveedor {{ prov.nombre }}" 
          class="provider-img">
      </div>

      <h3 class="provider-name">{{ prov.nombre }}</h3>

      <p class="provider-info phone">
        <i class="fas fa-phone"></i> {{ prov.telefono }}
      </p>

      <p class="provider-info location">
        <i class="fas fa-map-marker-alt"></i> {{ prov.direccion }}
      </p>

      <p class="provider-info">
        {% if prov.estado %}
          <span class="status active">● Activo</span>
        {% else %}
          <span class="status inactive">● Inactivo</span>
        {% endif %}
      </p>

      <div class="icons">
        <i class="fa-regular fa-trash-can delete-btn"
           onclick="abrirModalEliminar({{ prov.id }}, '{{ prov.nombre|escapejs }}', null)"
           title="Inactivar"></i>

        <i class="fa-regular fa-eye view-btn"
           onclick="abrirModalVer('{{ prov.nombre|escapejs }}', null, '{{ prov.telefono|escapejs }}', '{{ prov.direccion|escapejs }}', '{% if prov.estado %}Activo{% else %}Inactivo{% endif %}')"
           title="Ver"></i>

        <i class="fa-regular fa-pen-to-square edit-btn"
           onclick="abrirModalEditar({{ prov.id }})"
           title="Editar"></i>
      </div>

    </div>

    {% empty %}
      <p class="empty-state">
        No hay proveedores registrados
      </p>
    {% endfor %}

  </section>
</main>

<div class="modal" id="modalAdd">
  <div class="modal-content">
    {% include "proveedores/modal_agregar.html" %}
  </div>
</div>

<div class="modal" id="modalEdit">
  <div class="modal-content">
    {% include "proveedores/modal_editar.html" %}
  </div>
</div>

<div class="modal" id="modalView">
  <div class="modal-content view">
    {% include "proveedores/modal_view.html" %}
  </div>
</div>

<div class="modal" id="modalDelete">
  <div class="modal-content">
    {% include "proveedores/modal_delete.html" %}
  </div>
</div>

<script src="{% static 'ap1/js/proveedores_final.js' %}"></script>

{% endblock %}